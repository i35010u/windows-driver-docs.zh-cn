---
title: 确定是否存在泄漏
description: 确定是否存在泄漏
ms.assetid: a29db56e-6507-48f4-ad30-eb0a849f8673
keywords:
- 内存泄漏，检测
ms.date: 05/23/2017
ms.localizationpriority: medium
ms.openlocfilehash: a663125e0ce43b774769e1745ae83b58456f066e
ms.sourcegitcommit: eefc6ae6d9621d0735b3c63e718ee5838d57a6bc
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/28/2020
ms.locfileid: "92886068"
---
# <a name="determining-whether-a-leak-exists"></a>确定是否存在泄漏


如果 Windows 性能随着时间的推移而降级，并且您怀疑可能会涉及到内存泄露，则本部分所述的方法可以指示是否存在内存泄漏。 它不会告诉您泄露的来源是什么，或者它是用户模式还是内核模式。

首先启动性能监视器。 若要打开性能监视器，请使用下列过程之一：

- 打开 "开始" 菜单，搜索 "性能监视器"，然后单击结果 
- 使用 ```Windows Key + R``` 键盘快捷方式打开 " _运行_ " 命令，键入 ```perfmon``` ，然后单击 "确定" 以打开。

打开性能监视器后，添加以下计数器：

-   **Memory** -- 内存 &gt;**缓冲池非分页字节**

-   **Memory** -- 内存 &gt;**池分页字节数**

-   **页面文件** -- &gt;**使用百分比**

将更新时间更改为600秒，以捕获一段时间内泄漏的关系图。 你可能还需要将数据记录到文件中，以便以后检查。

启动您认为导致泄漏的应用程序或测试。 允许应用程序或测试在一段时间后运行不受影响;此时不要使用目标计算机。 泄漏通常很慢，并且可能需要几个小时来检测。 等待几个小时，然后再决定是否发生了泄漏。

监视性能监视器计数器。 开始测试后，计数器值将会快速变化，并且可能需要一段时间才能使内存池值达到稳定状态。

用户模式内存泄漏始终位于可分页池内，同时导致 " **池分页字节数** " 计数器和 "页面文件 **使用情况** " 计数器在一段时间内持续增长。 内核模式内存泄漏通常占用非分页池，这会导致 **池非分页字节** 计数器增加，尽管可分页的内存也会受到影响。 偶尔，这些计数器可能会显示误报，因为应用程序正在缓存数据。

 

 





